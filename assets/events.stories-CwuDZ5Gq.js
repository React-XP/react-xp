import{j as e}from"./jsx-runtime-Nms4Y4qS.js";import{R as a}from"./index-BwDkhjyp.js";import"./_commonjsHelpers-BosuxZz1.js";const b=a.createContext({}),l=({children:t,onEvent:r})=>e.jsx(b.Provider,{value:{onEvent:r},children:t});l.__docgenInfo={description:"",methods:[],displayName:"EventsProvider",props:{onEvent:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  event: TEventsCommonInput & T,
) => void`,signature:{arguments:[{type:{name:"intersection",raw:"TEventsCommonInput & T",elements:[{name:"signature",type:"object",raw:"{ key: string }",signature:{properties:[{key:"key",value:{name:"string",required:!0}}]}},{name:"signature",type:"object",raw:"{ payload: T }",signature:{properties:[{key:"payload",value:{name:"T",required:!0}}]}}]},name:"event"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const g=()=>a.useContext(b),E={},k=()=>{const t=a.useRef(E),[r,s]=a.useState(0);return{add:({key:n,callback:o})=>(t.current[n]=t.current[n]||new Set,t.current[n].add(o),()=>{t.current[n].delete(o)}),clear:({key:n})=>{t.current[n].clear()},state:t,update:()=>s(n=>n+1)}};function p({key:t}){const{state:r,update:s}=k(),{onEvent:n}=g();return{emit:i=>{n==null||n({key:t,payload:i});for(const c of r.current[t])c({payload:i});s()}}}function u({callback:t,key:r}){const{add:s}=k(),[n,o]=a.useState(0),i=({callback:c,key:v})=>s({callback:j=>{c(j),o(f=>f+1)},key:v});return a.useEffect(()=>{if(!t)return;const c=i({callback:t,key:r});return()=>{c()}},[]),{subscribe:i}}const h=()=>{const{emit:t}=p({key:"key"}),{emit:r}=p({key:"key2"});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Emitter"}),e.jsx("button",{type:"button",style:{border:"1px solid black",padding:"5px",borderRadius:"5px"},onClick:()=>t({msg:"hello"}),children:"Emit key=key"}),e.jsx("button",{type:"button",style:{border:"1px solid black",padding:"5px",borderRadius:"5px"},onClick:()=>r({msg:"hello key 2"}),children:"Emit key=key2"})]})},S=()=>{const[t,r]=a.useState();return u({key:"key",callback:({payload:s})=>r(s)}),e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Subscriber for key=[key]"}),e.jsx("br",{}),"Event payload: ",JSON.stringify(t)]})},T=()=>{const[t,r]=a.useState();return u({key:"key",callback:({payload:s})=>r(s)}),u({key:"key2",callback:({payload:s})=>r(s)}),e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Subscriber 2 for keys=[key,key2]"}),e.jsx("br",{}),"Event payload: ",JSON.stringify(t)]})},C=()=>e.jsxs(l,{onEvent:t=>{alert(`new event ${JSON.stringify(t)}`)},children:["This is a ","events"," example",e.jsx("br",{}),e.jsx(h,{}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{style:{display:"flex"},children:e.jsx(S,{})}),e.jsx("div",{style:{display:"flex"},children:e.jsx(T,{})})]})]}),_={component:l,title:"Packages/events"},d={render:()=>e.jsx(C,{})};var y,m,x;d.parameters={...d.parameters,docs:{...(y=d.parameters)==null?void 0:y.docs,source:{originalSource:`{
  render: () => <Component />
}`,...(x=(m=d.parameters)==null?void 0:m.docs)==null?void 0:x.source}}};const q=["HowToUse"];export{d as HowToUse,q as __namedExportsOrder,_ as default};
